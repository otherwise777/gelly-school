        <!DOCTYPE html><html>
            <head>
               <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                <title>Tutorial4</title>
                <link rel="stylesheet" type="text/css" href="styles.css">
            </head>
        <body>
                <div id="wrapper">

                <div id="header">
                <img src="./images/logo_color_50.png">
                    <h1>Learn you some Gelly</h1></img>
                 </div> <!-- header -->

		<div id="menu">
			<ul id="list-nav">
				<li class="first"><a href="http://gellyschool.com"
					title="Gelly Home">HomePage</a></li>
				<li><a href="./tut1.html"
					title="Load public data and create a graph">Tutorial#1</a></li>
				<li><a href="./tut2.html" title="Know your graph">Tutorial#2</a></li>
				<li><a href="./tut3.html" title="	Simple transformations">Tutorial#3</a></li>
				<li><a href="./tut4.html" title="Advanced transofrmations">Tutorial#4</a></li>
				<li><a href="./tut5.html" title="Neighborhood methods">Tutorial#5</a></li>
				<li><a href="./tut6.html" title="Implement a graph validator">Tutorial#6</a></li>
				<li><a href="./tut7.html" title="Vertex-centric iterations">Tutorial#7</a></li>
				<li><a href="./tut8.html" title="Gather-sum-apply iterations">Tutorial#8</a></li>
				<li class="last"><a
					href="https://github.com/apache/flink/tree/master/flink-staging/flink-gelly"
					title="Gelly on GitHub">SourceCode</a></li>
				</a>
				</li>
			</ul>
		</div>
		<!-- menu -->
                <div id="container">

<h2>Tutorial #4: Advanced Transformations</h2>
<h4>The business gets serious</h4>
<p style="margin-top: -20px">Let's carry on with applying some more but advanced transformations to our Gelly-Graph. </p>
<h4>Join</h4>
<p style="margin-top: -20px">Gelly provides specialized methods for joining the vertex and edge datasets with other input datasets. <strong><em>joinWithVertices</em></strong> joins the vertices with a Tuple2 input data set. The join is performed using the vertex ID and the first field of the Tuple2 input as the join keys. The method returns a new Graph where the vertex values have been updated according to a provided user-defined map function. 
Similarly, an input dataset can be joined with the edges, using one of the three methods: <strong><em>joinWithEdges</em></strong> expects an input DataSet of Tuple3 and joins on the composite key of both source and target vertex IDs. <strong><em>joinWithEdgesOnSource</em></strong> expects a DataSet of Tuple2 and joins on the source key of the edges and the first attribute of the input dataset and <strong><em>joinWithEdgesOnTarget</em></strong> expects a DataSet of Tuple2 and joins on the target key of the edges and the first attribute of the input dataset. All three methods apply a map function on the edge and the input data set values. Note that if the input dataset contains a key multiple times, all Gelly join methods will only consider the first value encountered. For example,</p>
<pre><code>    DataSet&lt;Tuple2&lt;Long, Long&gt;&gt; vOutDegrees = graph.outDegrees();

    // assign the transition probabilities as the edge weights
    Graph&lt;Long, Double, Double&gt; network1 = graph.joinWithEdgesOnSource(vOutDegrees,
                    new MapFunction&lt;Tuple2&lt;Double, Long&gt;, Double&gt;() {
                        public Double map(Tuple2&lt;Double, Long&gt; value) {
                            return value.f0 / value.f1;
                        }
                    });

    Graph&lt;Long, Double, Double&gt; network2 = graph.joinWithEdgesOnTarget(vOutDegrees,
            new MapFunction&lt;Tuple2&lt;Double, Long&gt;, Double&gt;() {
                public Double map(Tuple2&lt;Double, Long&gt; value) {
                    return value.f0 / value.f1;
                }
            });     

    Graph&lt;Long, Double, Double&gt; network3 = graph.joinWithVertices(vOutDegrees,
            new MapFunction&lt;Tuple2&lt;Double, Long&gt;, Double&gt;() {
                public Double map(Tuple2&lt;Double, Long&gt; value) {
                    return 1.0 / value.f1;
                }
            });
</code></pre>
<br>
<h4>Union</h4>
<p style="margin-top: -20px">Gelly’s union() method performs a union operation on the vertex and edge sets of the specified graph and current graph. Duplicate vertices are removed from the resulting Graph, while if duplicate edges exists, these will be maintained. (<strong>drawing of graph</strong>)</p>
<pre><code>    network2.union(network3);
</code></pre>
<br><br>
<h4>Difference</h4>
<p style="margin-top: -20px">Gelly’s difference() method performs a difference on the vertex and edge sets of the current graph and specified graph.</p>
<p>This concludes our discussion regarding transformations in Gelly. Next, we are going to look at some other advanced topics like neighborhood methods and graph validation. </p>

                </div><!-- content -->
                <div id="footer">
                    <p>This site is maintained by  <a href="https://github.com/vasia">Vasia</a></p>
                </div> <!-- footer -->
            </div> <!-- wrapper -->


        </body>
        </html>
